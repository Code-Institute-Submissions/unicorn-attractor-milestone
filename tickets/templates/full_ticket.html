{% extends 'base.html' %}
{% load staticfiles %}
{% load bootstrap_tags %}
{% block page_title %} Full Ticket {% endblock %}
{% block page_heading %} Full Ticket {% endblock %}
{% block content %}
<div class="container">
	<div class="row">
		<div class="col-xs-12 full-ticket-header">
			<h1 class="white-text issue-bottom-margin">{{ticket.category}}: {{ ticket.title }}</h1>
		</div>
		<div class="col-xs-12 full-ticket-outer">
			<div class="full-ticket-inner">
                <p class="issue-bottom-margin">Created on: {{ ticket.created_on }}</p>
				<p class="issue-bottom-margin">Description: {{ ticket.description }}</p>
				<p class="issue-bottom-margin">Priority: {{ ticket.priority }}</p>
				<p>Votes: {{ ticket.votes }}</p>
				{% if user.is_authenticated %}
				{% if ticket.reported_by == request.user %}
				<p class="italic-text issue-bottom-margin">You reported / requested this ticket</p>
				{% elif user in ticket.voters.all %}
				<p class="italic-text issue-bottom-margin">You have already voted on this ticket</p>
				{% else %}
				<p><a class="purple-text issue-bottom-margin" href="{% url 'upvote' ticket_id=ticket.id%}">Upvote
						<i class="fa fa-arrow-up"></i></a>
				</p>
				{% endif %}

				<div>
					<a class="purple-text" onClick="toggleComment(this)">Comments
						<i class="fa fa-chevron-down" aria-hidden="true"></i></a>
					</br>
					<a class="purple-text" href="{% url 'add_ticket_comment' ticket_id=ticket.id%}">Add Comment
						<i class="fa fa-plus" aria-hidden="true"></i></a>
				</div>
				<div class="comment-block">
					<div class="comments">
						{% for comment in ticket.comments.all %}
						<div class="comment-bold">{{ comment.created }}</div>
						<p class="comment-bold"> User: {{ comment.commenter }}</p>
						<p> Comment: {{ comment.comment }}</p>
						<hr />
						{% empty %}
						<div>
							<p class="italic-text">No comments yet</p>
						</div>
						{% endfor %}
					</div>
				</div>
				{% endif %}
			</div>
		</div>
	</div>


	{% endblock %}